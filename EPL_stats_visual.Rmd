---
title: "Hw 2"
author: "Connor Eastman"
date: "2024-03-09"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(shiny)
library(tidytuesdayR)
library(tidyverse)
library(ggplot2)
```

```{r}
# tuesdata <- tidytuesdayR::tt_load('2023-04-04')
# soccer <- tuesdata$soccer

soccer <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-04-04/soccer21-22.csv')

head(soccer, 10)
```

# Premier League Match Data: 2021-2022
Data Retrieved from [TidyTuesday](https://github.com/rfordatascience/tidytuesday/blob/master/data/2023/2023-04-04/readme.md)


```{r}
team_stats_Home = soccer %>%
  group_by(HomeTeam) %>%
  summarise(
    home_wins = sum(FTR == "H"),
    home_losses = sum(FTR == "A"),
    home_draws = sum(FTR == "D")
  ) %>%
  rename(team_ID = HomeTeam)

team_stats_Away = soccer %>%
  group_by(AwayTeam) %>%
  summarise(
    Away_wins = sum(FTR == "A"),
    Away_losses = sum(FTR == "H"),
    Away_draws = sum(FTR == "D")
  ) %>%
  rename(team_ID = AwayTeam)

complete_team_stats <- full_join(team_stats_Home, team_stats_Away, by = "team_ID")

complete_team_stats = complete_team_stats %>%
  mutate(tot_wins = home_wins+Away_wins, 
         tot_losses = home_losses+Away_losses, 
         tot_draws = home_draws+Away_draws)

# head(complete_team_stats)
```

```{r}
plot_stats = function(team_name) {
  team_data <- complete_team_stats %>%
    filter(team_ID == team_name) %>%
    select(team_ID, tot_wins, tot_losses, tot_draws) %>%
    gather(key = "Statistic", value = "Count", -team_ID)
  
  ggplot(team_data, aes(x = Statistic, y = Count, fill = Statistic)) +
    geom_bar(stat = "identity", show.legend = FALSE) +
    theme_minimal() +
    labs(title = paste("Total Wins, Losses, and Draws for", team_name),
         x = "Outcome",
         y = "Count") +
    scale_fill_brewer(palette = "Set1") +
    scale_x_discrete(labels = c("tot_wins" = "Wins", "tot_losses" = "Losses", "tot_draws" = "Draws"))
}

plot_stats("Chelsea")

```




```{r}
ui = fluidPage(
  sidebarLayout(
    sidebarPanel(
      selectInput("team", "Team", unique(soccer$HomeTeam))
    ),
    mainPanel(
      plotOutput("team_stats")
    )
  )
)

server = function(input, output) {
  output$team_stats = renderPlot(
    
  )
}

shinyApp(ui, server)
```

